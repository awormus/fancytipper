<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Fancy Tipper</title>
    <meta name="viewport" content="user-scalable=no,initial-scale = 1.0,maximum-scale = 1.0">
    <link rel="stylesheet" type="text/css" href="css/topcoat-mobile-dark.min.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
	<link rel="stylesheet" type="text/css" href="css/brackets.css">
  </head>
  <body class="dark">
    <div id="wrapper">
      <div class="max-width">
        <div id="sideNav">
          <nav class="site">
            <ul>
              <li><a href="http://topcoat.io">Home</a></li>
              <li class="selected"><a href="http://topcoat.io/topcoat">Usage Guidelines</a></li>
              <li><a href="http://bench.topcoat.io/">Benchmarks</a></li>
              <li><a href="http://topcoat.io/blog">Blog</a></li>
            </ul>
          </nav>
        </div>
      </div>
      <div id="site">
        <header id="main-header">
          <div class="max-width">
            <hgroup>
              <h1>FancyTipper</h1>
              <p>Taking the math out of fancy tipping</p>
            </hgroup>
            <nav>
              <ul>
                <li class="selected"><a href="http://bench.topcoat.io/">About FancyTipper</a></li>
                <li><a href="http://topcoat.io/blog">Blog</a></li>
              </ul>
            </nav><a id="slide-menu-button" class="topcoat-icon-button--large--quiet"><span class="topcoat-icon--large topcoat-icon--menu-stack"></span></a>
          </div>
        </header>
		<div id="content" class="max-width">
          <article id="button" class="component">
            <header>
              <h2>Enter the Total Bill</h2>
            </header>

			<input type="number" class="topcoat-text-input--large" value="" id="total" placeholder="Enter Total Bill">

			</article>
			<article>
			<header>
			  <h2>Select your style</h2>
			</header>

			<a class="topcoat-button">Palindrome</a>
			<a class="topcoat-button">Rounded</a>
			<a class="topcoat-button">.88</a>
			</article>

			<article>

			<div class="topcoat-list__container">
				<ul class="topcoat-list">
					<li class="topcoat-list__item">
					10% tip: <span id="10tip"></span>
					</li>
					<li class="topcoat-list__item">
					20% tip: <span id="20tip"></span>
					</li>
					<li class="topcoat-list__item">
					30% tip: <span id="30tip"></span>
					</li>
				</ul>
			</div>
			</article>
        </div>
        <footer></footer>
      </div>
    </div>
    <script src="//use.edgefonts.net/source-sans-pro:n3,n4,n6;source-code-pro:n3.js"></script>
    <script src="js/rainbow-custom.min.js"></script>
	<script src="js/main.js"></script>
    <script src="js/zepto.min.js"></script>
	
	<script>
		$("#total").bind('keydown', function (e) {
		 if ( event.keyCode == 190 || event.keyCode == 46 || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 27 || 
				 // Allow: Ctrl+A
				(event.keyCode == 65 && event.ctrlKey === true) || 
				 // Allow: home, end, left, right
				(event.keyCode >= 35 && event.keyCode <= 39)) {
					 // let it happen, don't do anything
					 return;
			}
			else {
				// Ensure that it is a number and stop the keypress
				if (event.keyCode == 13 || event.shiftKey || (event.keyCode < 48 || event.keyCode > 57) && (event.keyCode < 96 || event.keyCode > 105 )) {
					event.preventDefault(); 
				}   
			}
		});

		$("#total").bind('keyup', function (e) {
		var priceFloat = parseFloat($("#total").val());
		var tip10 = round2points(priceFloat * .10 + priceFloat);
		var tip20 = round2points(priceFloat * .20 + priceFloat);
		var tip30 = round2points(priceFloat * .30 + priceFloat);

			$("#10tip").text(tip10 + " : " + findClosestPalindrome(tip10)); 
			$("#20tip").text(tip20 + " : " + findClosestPalindrome(tip20)); 
			$("#30tip").text(tip30 + " : " + findClosestPalindrome(tip30)); 

			$("#sametip").text(findClosestNumber(priceFloat));
			$("#palindrometip").text(findClosestPalindrome(priceFloat));
		});

		function round2points(price){
		var result = Math.round(price*100)/100;
		return result;
		}

		function findClosestNumber(price){
			return price;
		}

		function getPercentChange(price1, price2){
		return price1/price2*100;
		}

		function findClosestPalindrome(price){
		var sPrice = price.toString();
		var str2 = sPrice.replace(/\./g,"");
		var len = str2.length;
		var halflen = Math.floor(len / 2);
		var ddd = halflen;
		var firstPart = sPrice.substr(0, halflen);
		var middlePart = "";
		var lastPart = sPrice.substr(-halflen);

		if (firstPart < lastPart){
			firstPart1 = parseFloat(firstPart);
			firstPart = Math.floor(firstPart1+1).toString();
		}

		if (len%2){
			middlePart = sPrice.substr(halflen,1);
		}
		
		lastPart = firstPart.split("").reverse().join("");
		ddd = firstPart +  middlePart + lastPart;
		retVal = ddd.substr(0, ddd.length-2)+"."+ddd.substr(-2);
		return retVal ;

		}

		$("#total").focus();
	</script>
  </body>
</html>
